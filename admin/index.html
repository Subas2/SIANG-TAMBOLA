<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOD PANEL ‚Äì Siang Tambola Admin</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Poppins:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --bg: #0f0828;
            --bg2: #150d38;
            --card: #1e1248;
            --card2: #251555;
            --accent: #7c3aed;
            --accent2: #6d28d9;
            --neon: #8b5cf6;
            --cyan: #06b6d4;
            --gold: #f59e0b;
            --green: #10b981;
            --red: #ef4444;
            --orange: #f97316;
            --text: #e2d9f3;
            --muted: #7c6fa0;
            --border: rgba(124, 58, 237, 0.25);
            /* Admin red accent override */
            --a-red: #ff003c;
            --a-red-glow: rgba(255, 0, 60, 0.3);
        }

        html,
        body {
            height: 100%;
            font-family: 'Nunito', sans-serif;
            background: var(--bg);
            color: var(--text);
            overflow-x: hidden;
        }

        ::-webkit-scrollbar {
            width: 4px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 10px;
        }

        /* ---- PROFILE PANEL ---- */
        .profile-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            backdrop-filter: blur(4px);
        }

        .profile-overlay.open {
            opacity: 1;
            pointer-events: all;
        }

        .profile-sheet {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%) translateY(100%);
            width: 100%;
            max-width: 480px;
            background: #12091f;
            border-radius: 24px 24px 0 0;
            z-index: 201;
            padding: 12px 0 0;
            transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            border-top: 2px solid rgba(255, 0, 60, 0.4);
        }

        .profile-overlay.open .profile-sheet {
            transform: translateX(-50%) translateY(0);
        }

        .ps-handle {
            width: 40px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            margin: 0 auto 20px;
        }

        .ps-avatar {
            width: 72px;
            height: 72px;
            background: linear-gradient(135deg, var(--a-red), #7c3aed);
            border-radius: 50%;
            margin: 0 auto 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            box-shadow: 0 0 25px rgba(255, 0, 60, 0.4);
        }

        .ps-name {
            text-align: center;
            font-size: 1.2rem;
            font-weight: 900;
        }

        .ps-sub {
            text-align: center;
            font-size: 0.8rem;
            color: var(--muted);
            margin-top: 4px;
            margin-bottom: 20px;
        }

        .ps-rows {
            padding: 0 20px;
        }

        .ps-row {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px 16px;
            background: var(--card2);
            border-radius: 12px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid rgba(255, 255, 255, 0.04);
        }

        .ps-row:hover {
            background: rgba(255, 0, 60, 0.1);
            border-color: rgba(255, 0, 60, 0.3);
        }

        .ps-row-icon {
            font-size: 1.2rem;
            width: 36px;
            text-align: center;
        }

        .ps-row-label {
            font-weight: 700;
            font-size: 0.9rem;
        }

        .ps-row-arrow {
            margin-left: auto;
            color: var(--muted);
            font-size: 0.8rem;
        }

        .ps-logout-btn {
            display: block;
            margin: 8px 20px;
            padding: 14px;
            border-radius: 12px;
            border: 1px solid rgba(255, 0, 60, 0.35);
            background: rgba(255, 0, 60, 0.08);
            color: var(--a-red);
            font-family: 'Nunito', sans-serif;
            font-size: 0.95rem;
            font-weight: 800;
            cursor: pointer;
            width: calc(100% - 40px);
            text-align: center;
            transition: all 0.2s;
            margin-bottom: 30px;
        }

        .ps-logout-btn:hover {
            background: rgba(255, 0, 60, 0.18);
        }

        /* profile icon btn */
        .profile-icon-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }

        .profile-icon-btn:hover {
            transform: scale(1.1);
        }

        .profile-icon-btn svg {
            width: 32px;
            height: 32px;
        }

        #app {
            max-width: 480px;
            margin: 0 auto;
            min-height: 100vh;
            background: var(--bg);
            display: flex;
            flex-direction: column;
            position: relative;
        }

        @media (min-width: 481px) {
            #app {
                box-shadow: 0 0 60px rgba(0, 0, 0, 0.5);
            }
        }

        /* ---- LOGIN ---- */
        .login-wrap {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
        }

        .login-card {
            width: 100%;
            max-width: 400px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 0, 60, 0.35);
            border-radius: 20px;
            padding: 50px 36px;
            box-shadow: 0 0 60px rgba(255, 0, 60, 0.12), inset 0 0 40px rgba(255, 0, 60, 0.03);
            backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
        }

        .login-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--a-red), var(--neon), var(--a-red), transparent);
        }

        .lc-logo {
            font-size: 1.6rem;
            font-weight: 900;
            text-align: center;
            color: var(--a-red);
            text-shadow: 0 0 30px var(--a-red);
            letter-spacing: 2px;
            margin-bottom: 4px;
        }

        .lc-sub {
            text-align: center;
            color: var(--muted);
            font-size: 0.8rem;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 36px;
        }

        .field {
            margin-bottom: 18px;
        }

        .field label {
            display: block;
            font-size: 0.72rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--muted);
            margin-bottom: 7px;
        }

        .field input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 0, 60, 0.25);
            border-radius: 10px;
            padding: 13px 16px;
            color: #fff;
            font-size: 0.95rem;
            outline: none;
            transition: all 0.3s;
            font-family: 'Nunito', sans-serif;
        }

        .field input:focus {
            border-color: var(--a-red);
            background: rgba(255, 0, 60, 0.07);
            box-shadow: 0 0 20px rgba(255, 0, 60, 0.15);
        }

        .login-btn {
            width: 100%;
            margin-top: 8px;
            padding: 15px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--a-red), #cc0030);
            color: #fff;
            font-family: 'Nunito', sans-serif;
            font-size: 1rem;
            font-weight: 800;
            letter-spacing: 2px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 30px rgba(255, 0, 60, 0.4);
            text-transform: uppercase;
        }

        .login-btn:hover {
            background: linear-gradient(135deg, #ff1a4d, var(--a-red));
            box-shadow: 0 4px 50px rgba(255, 0, 60, 0.7);
            transform: translateY(-2px);
        }

        /* ---- HEADER ---- */
        .app-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 18px;
            background: var(--bg2);
            border-bottom: 1px solid rgba(255, 0, 60, 0.2);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo-text {
            font-size: 1.15rem;
            font-weight: 900;
            font-style: italic;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo-badge {
            background: var(--a-red);
            color: #fff;
            font-size: 0.62rem;
            font-weight: 800;
            padding: 2px 8px;
            border-radius: 20px;
            letter-spacing: 1px;
            font-style: normal;
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: var(--green);
            border-radius: 50%;
            box-shadow: 0 0 8px var(--green);
            animation: blink 1.5s infinite;
        }

        @keyframes blink {

            0%,
            100% {
                opacity: 1
            }

            50% {
                opacity: 0.3
            }
        }

        .hdr-btns {
            display: flex;
            gap: 8px;
        }

        .icon-btn {
            width: 36px;
            height: 36px;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.2s;
        }

        .icon-btn:hover {
            background: var(--a-red);
            border-color: var(--a-red);
        }

        .logout-pill {
            padding: 7px 16px;
            background: transparent;
            border: 1px solid rgba(255, 0, 60, 0.3);
            border-radius: 20px;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.8rem;
            font-weight: 700;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.25s;
            font-family: 'Nunito', sans-serif;
        }

        .logout-pill:hover {
            border-color: var(--a-red);
            color: var(--a-red);
            box-shadow: 0 0 12px rgba(255, 0, 60, 0.3);
        }

        /* ---- STATS BAR ---- */
        .stats-bar {
            display: flex;
            background: rgba(255, 255, 255, 0.02);
            border-bottom: 1px solid rgba(255, 255, 255, 0.04);
            overflow-x: auto;
        }

        .stats-bar::-webkit-scrollbar {
            display: none;
        }

        .stat-pill {
            flex-shrink: 0;
            padding: 10px 18px;
            display: flex;
            flex-direction: column;
            gap: 2px;
            border-right: 1px solid rgba(255, 255, 255, 0.04);
        }

        .sp-lbl {
            font-size: 0.62rem;
            color: var(--muted);
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }

        .sp-val {
            font-family: 'Poppins', sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
        }

        /* ---- TABS ---- */
        .tab-bar {
            display: flex;
            background: var(--bg2);
            padding: 6px 14px;
            gap: 4px;
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
        }

        .tab-bar::-webkit-scrollbar {
            display: none;
        }

        .tab-item {
            flex-shrink: 0;
            padding: 7px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.25s;
            color: var(--muted);
            background: transparent;
            border: none;
            font-family: 'Nunito', sans-serif;
        }

        .tab-item.active {
            background: rgba(255, 0, 60, 0.15);
            color: #fff;
            border: 1px solid rgba(255, 0, 60, 0.3);
        }

        /* ---- PAGES ---- */
        .page {
            display: none;
            flex-direction: column;
            gap: 14px;
            padding: 14px;
            overflow-y: auto;
            flex: 1;
        }

        .page.active {
            display: flex;
        }

        .section-title {
            font-size: 0.95rem;
            font-weight: 800;
            color: var(--text);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* ---- CARDS ---- */
        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 16px;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
        }

        .card.red-top::before {
            background: linear-gradient(90deg, transparent, var(--a-red), transparent);
        }

        .card.gold-top::before {
            background: linear-gradient(90deg, transparent, var(--gold), transparent);
        }

        .card.cyan-top::before {
            background: linear-gradient(90deg, transparent, var(--cyan), transparent);
        }

        .card.green-top::before {
            background: linear-gradient(90deg, transparent, var(--green), transparent);
        }

        .card.purple-top::before {
            background: linear-gradient(90deg, transparent, var(--neon), transparent);
        }

        /* ---- QUICK ACTIONS ---- */
        .qa-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .qa-item {
            background: var(--card2);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 14px 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 7px;
            cursor: pointer;
            transition: all 0.25s;
        }

        .qa-item:hover {
            background: rgba(255, 0, 60, 0.12);
            border-color: rgba(255, 0, 60, 0.4);
            transform: translateY(-2px);
        }

        .qa-icon {
            font-size: 1.4rem;
        }

        .qa-label {
            font-size: 0.72rem;
            font-weight: 800;
            text-align: center;
        }

        /* ---- GAME CONTROL ---- */
        .live-ctrl {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 18px;
            margin-bottom: 18px;
        }

        .live-circle-wrap {
            position: relative;
            width: 110px;
            height: 110px;
        }

        .live-circle-svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .live-circle-svg circle.track {
            fill: none;
            stroke: rgba(255, 0, 60, 0.15);
            stroke-width: 5;
        }

        .live-circle-svg circle.progress {
            fill: none;
            stroke: url(#adminGrad);
            stroke-width: 5;
            stroke-linecap: round;
            stroke-dasharray: 313;
            stroke-dashoffset: 0;
            transition: stroke-dashoffset 0.5s ease;
        }

        .live-center {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .live-lbl {
            font-size: 0.6rem;
            font-weight: 800;
            letter-spacing: 2px;
            color: var(--muted);
            text-transform: uppercase;
        }

        .live-num {
            font-size: 2rem;
            font-weight: 900;
            font-family: 'Poppins', sans-serif;
            color: #fff;
            line-height: 1;
        }

        /* Draw button */
        .draw-btn {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, var(--a-red), #cc0030);
            color: #fff;
            font-size: 1.8rem;
            cursor: pointer;
            box-shadow: 0 0 25px rgba(255, 0, 60, 0.5);
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 2px;
        }

        .draw-btn:hover {
            transform: scale(1.08);
            box-shadow: 0 0 40px rgba(255, 0, 60, 0.7);
        }

        .draw-btn:active {
            transform: scale(0.96);
        }

        .draw-btn span {
            font-size: 0.55rem;
            font-weight: 800;
            letter-spacing: 1px;
            text-transform: uppercase;
            color: rgba(255, 255, 255, 0.7);
            font-family: 'Nunito', sans-serif;
        }

        /* Speed control */
        .speed-row {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--card2);
            border-radius: 10px;
            padding: 10px 14px;
            margin-bottom: 12px;
        }

        .speed-row label {
            font-size: 0.8rem;
            color: var(--muted);
            white-space: nowrap;
        }

        .speed-row input[type=range] {
            flex: 1;
            accent-color: var(--a-red);
        }

        .speed-val {
            font-weight: 800;
            font-size: 0.9rem;
            color: var(--a-red);
            width: 30px;
            text-align: right;
        }

        /* Number Board */
        .number-board {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 4px;
        }

        .nb-cell {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            background: var(--card2);
            font-size: 0.72rem;
            font-weight: 700;
            color: var(--muted);
            cursor: default;
            transition: all 0.3s;
            border: 1px solid transparent;
        }

        .nb-cell.called {
            background: linear-gradient(135deg, var(--a-red), #cc0030);
            color: #fff;
            border-color: rgba(255, 0, 60, 0.5);
            box-shadow: 0 0 8px rgba(255, 0, 60, 0.4);
        }

        .nb-cell.latest {
            background: linear-gradient(135deg, #ff003c, #ff6b00);
            color: #fff;
            box-shadow: 0 0 15px rgba(255, 0, 60, 0.7);
            transform: scale(1.1);
            z-index: 2;
        }

        @keyframes pop {
            0% {
                transform: scale(0.5);
                opacity: 0
            }

            70% {
                transform: scale(1.2)
            }

            100% {
                transform: scale(1.1)
            }
        }

        .nb-cell.latest {
            animation: pop 0.4s ease forwards;
        }

        /* Buttons */
        .g-btn {
            width: 100%;
            padding: 13px 16px;
            border-radius: 10px;
            border: 1px solid;
            background: transparent;
            font-family: 'Nunito', sans-serif;
            font-size: 0.9rem;
            font-weight: 700;
            letter-spacing: 0.5px;
            cursor: pointer;
            transition: all 0.25s;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .g-btn:last-child {
            margin-bottom: 0;
        }

        .g-btn.red {
            border-color: rgba(255, 0, 60, 0.4);
            color: #fff;
            background: linear-gradient(135deg, rgba(255, 0, 60, 0.6), rgba(200, 0, 40, 0.7));
            box-shadow: 0 3px 15px rgba(255, 0, 60, 0.25);
        }

        .g-btn.red:hover {
            background: linear-gradient(135deg, var(--a-red), #cc0030);
            box-shadow: 0 3px 30px rgba(255, 0, 60, 0.5);
        }

        .g-btn.cyan {
            border-color: rgba(6, 182, 212, 0.35);
            color: var(--cyan);
            background: rgba(6, 182, 212, 0.05);
        }

        .g-btn.cyan:hover {
            background: rgba(6, 182, 212, 0.12);
            border-color: var(--cyan);
            box-shadow: 0 0 15px rgba(6, 182, 212, 0.3);
            color: #fff;
        }

        .g-btn.gold {
            border-color: rgba(245, 158, 11, 0.35);
            color: var(--gold);
            background: rgba(245, 158, 11, 0.05);
        }

        .g-btn.gold:hover {
            background: rgba(245, 158, 11, 0.12);
            border-color: var(--gold);
            box-shadow: 0 0 15px rgba(245, 158, 11, 0.3);
            color: #fff;
        }

        .g-btn.green {
            border-color: rgba(16, 185, 129, 0.35);
            color: var(--green);
            background: rgba(16, 185, 129, 0.05);
        }

        .g-btn.green:hover {
            background: rgba(16, 185, 129, 0.12);
            border-color: var(--green);
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.3);
            color: #fff;
        }

        .g-btn.purple {
            border-color: rgba(139, 92, 246, 0.35);
            color: var(--neon);
            background: rgba(139, 92, 246, 0.05);
        }

        .g-btn.purple:hover {
            background: rgba(139, 92, 246, 0.12);
            border-color: var(--neon);
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.3);
            color: #fff;
        }

        .g-btn.ghost {
            border-color: rgba(255, 255, 255, 0.1);
            color: var(--muted);
        }

        .g-btn.ghost:hover {
            border-color: rgba(255, 255, 255, 0.3);
            color: #fff;
            background: rgba(255, 255, 255, 0.05);
        }

        /* ---- CLAIM QUEUE ---- */
        .claim-item {
            background: var(--card2);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 14px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .ci-info {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .ci-player {
            font-weight: 800;
            font-size: 0.9rem;
        }

        .ci-pattern {
            font-size: 0.75rem;
            color: var(--muted);
        }

        .ci-actions {
            display: flex;
            gap: 6px;
        }

        .ci-btn {
            padding: 6px 14px;
            border-radius: 8px;
            border: none;
            font-size: 0.78rem;
            font-weight: 800;
            cursor: pointer;
            font-family: 'Nunito', sans-serif;
            transition: all 0.2s;
        }

        .ci-btn.approve {
            background: var(--green);
            color: #fff;
        }

        .ci-btn.reject {
            background: var(--card);
            border: 1px solid rgba(255, 0, 60, 0.3);
            color: var(--a-red);
        }

        .ci-btn:hover {
            opacity: 0.85;
            transform: scale(0.97);
        }

        /* ---- PLAYER LIST ---- */
        .player-item {
            background: var(--card2);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .pi-info {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .pi-name {
            font-weight: 800;
            font-size: 0.9rem;
        }

        .pi-sub {
            font-size: 0.72rem;
            color: var(--muted);
        }

        .pi-badge {
            font-size: 0.72rem;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 20px;
        }

        .pi-badge.active {
            background: rgba(16, 185, 129, 0.15);
            color: var(--green);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .pi-badge.banned {
            background: rgba(255, 0, 60, 0.12);
            color: var(--a-red);
            border: 1px solid rgba(255, 0, 60, 0.3);
        }

        /* ---- WALLET ROWS ---- */
        .wallet-row {
            background: var(--card2);
            border-radius: 10px;
            padding: 14px 16px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.04);
        }

        .wr-label {
            font-size: 0.85rem;
            color: var(--muted);
        }

        .wr-val {
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            font-size: 1rem;
        }

        /* ---- TOGGLE ---- */
        .toggle-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.04);
        }

        .toggle-row:last-child {
            border-bottom: none;
        }

        .toggle-lbl {
            font-size: 0.9rem;
            font-weight: 700;
        }

        .toggle-sub {
            font-size: 0.72rem;
            color: var(--muted);
        }

        /* Toggle switch */
        .switch {
            position: relative;
            width: 44px;
            height: 24px;
            flex-shrink: 0;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            transition: 0.3s;
        }

        .slider::before {
            position: absolute;
            content: '';
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background: #fff;
            border-radius: 50%;
            transition: 0.3s;
        }

        input:checked+.slider {
            background: var(--a-red);
            box-shadow: 0 0 10px rgba(255, 0, 60, 0.4);
        }

        input:checked+.slider::before {
            transform: translateX(20px);
        }

        /* ---- BOTTOM NAV ---- */
        .bottom-nav {
            display: flex;
            background: var(--bg2);
            border-top: 1px solid rgba(255, 0, 60, 0.15);
            padding: 8px 0 4px;
            position: sticky;
            bottom: 0;
            z-index: 100;
        }

        .bnav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 3px;
            cursor: pointer;
            padding: 5px 0;
            transition: all 0.2s;
            border: none;
            background: transparent;
        }

        .bnav-item .bi-icon {
            font-size: 1.2rem;
        }

        .bnav-item .bi-label {
            font-size: 0.6rem;
            color: var(--muted);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-family: 'Nunito', sans-serif;
        }

        .bnav-item.active .bi-label {
            color: var(--a-red);
        }

        .bnav-item.active .bi-icon {
            filter: drop-shadow(0 0 6px var(--a-red));
        }

        /* Colors */
        .c-red {
            color: var(--a-red);
        }

        .c-cyan {
            color: var(--cyan);
        }

        .c-gold {
            color: var(--gold);
        }

        .c-green {
            color: var(--green);
        }

        .c-purple {
            color: var(--neon);
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>

<body>
    <div id="app">

        <!-- ===== LOGIN ===== -->
        <div class="login-wrap" id="view-login">
            <div class="login-card">
                <div class="lc-logo">‚ö° GOD PANEL</div>
                <div class="lc-sub">Admin Command Center</div>
                <form id="login-form">
                    <div class="field">
                        <label>Admin ID</label>
                        <input type="text" id="admin-id" placeholder="Enter admin credentials" required>
                    </div>
                    <div class="field">
                        <label>Password</label>
                        <input type="password" id="admin-pass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    <button type="submit" class="login-btn">üîì Override Protocol</button>
                </form>
            </div>
        </div>

        <!-- ===== DASHBOARD ===== -->
        <div id="view-dash" class="hidden" style="display:flex;flex-direction:column;min-height:100vh;">

            <!-- Header -->
            <header class="app-header">
                <div class="logo-text">
                    God Panel <div class="live-dot"></div>
                    <span class="logo-badge">ADMIN</span>
                </div>
                <div class="hdr-btns">
                    <div class="icon-btn" title="Alerts">üîî</div>
                    <button class="profile-icon-btn" onclick="openProfile()" title="Admin Profile">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="12" cy="8" r="4" stroke="#e2d9f3" stroke-width="1.8" />
                            <path d="M4 20c0-4 3.582-7 8-7s8 3 8 7" stroke="#e2d9f3" stroke-width="1.8"
                                stroke-linecap="round" />
                        </svg>
                    </button>
                </div>
            </header>

            <!-- Stats Bar -->
            <div class="stats-bar">
                <div class="stat-pill">
                    <div class="sp-lbl">Players</div>
                    <div class="sp-val c-cyan">1,240</div>
                </div>
                <div class="stat-pill">
                    <div class="sp-lbl">Games</div>
                    <div class="sp-val c-gold">3</div>
                </div>
                <div class="stat-pill">
                    <div class="sp-lbl">Agents</div>
                    <div class="sp-val c-purple">45</div>
                </div>
                <div class="stat-pill">
                    <div class="sp-lbl">Claims</div>
                    <div class="sp-val c-red">7</div>
                </div>
                <div class="stat-pill">
                    <div class="sp-lbl">Revenue</div>
                    <div class="sp-val c-green">‚Çπ24K</div>
                </div>
            </div>

            <!-- Tabs -->
            <div class="tab-bar">
                <button class="tab-item active" onclick="switchTab('game', this)">Game Control</button>
                <button class="tab-item" onclick="switchTab('claims', this)">Claims üî•</button>
                <button class="tab-item" onclick="switchTab('players', this)">Players</button>
                <button class="tab-item" onclick="switchTab('wallet', this)">Revenue</button>
                <button class="tab-item" onclick="switchTab('settings', this)">Settings</button>
            </div>

            <!-- ===== PAGE: GAME CONTROL ===== -->
            <div class="page active" id="page-game">

                <!-- Quick Admin Actions -->
                <div class="card red-top">
                    <div class="section-title">‚ö° Quick Actions</div>
                    <div class="qa-grid">
                        <div class="qa-item" onclick="initRoom()">
                            <div class="qa-icon">üöÄ</div>
                            <div class="qa-label">New Game Room</div>
                        </div>
                        <div class="qa-item" onclick="toggleAI()">
                            <div class="qa-icon">ü§ñ</div>
                            <div class="qa-label">AI Auto Caller</div>
                        </div>
                        <div class="qa-item">
                            <div class="qa-icon">üé´</div>
                            <div class="qa-label">Issue Tickets</div>
                        </div>
                        <div class="qa-item" onclick="switchTab('claims', null)">
                            <div class="qa-icon">‚úÖ</div>
                            <div class="qa-label">Review Claims</div>
                        </div>
                        <div class="qa-item">
                            <div class="qa-icon">üì¢</div>
                            <div class="qa-label">Announce</div>
                        </div>
                        <div class="qa-item">
                            <div class="qa-icon">üõë</div>
                            <div class="qa-label">End Game</div>
                        </div>
                    </div>
                </div>

                <!-- Live Draw Control -->
                <div class="card gold-top">
                    <div class="section-title">üéØ Live Draw Engine</div>

                    <div class="live-ctrl">
                        <!-- Number Circle -->
                        <div class="live-circle-wrap">
                            <svg class="live-circle-svg" viewBox="0 0 100 100">
                                <defs>
                                    <linearGradient id="adminGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                        <stop offset="0%" style="stop-color:#ff003c" />
                                        <stop offset="100%" style="stop-color:#f97316" />
                                    </linearGradient>
                                </defs>
                                <circle class="track" cx="50" cy="50" r="44" />
                                <circle class="progress" id="admin-arc" cx="50" cy="50" r="44" />
                            </svg>
                            <div class="live-center">
                                <div class="live-lbl">CALLED</div>
                                <div class="live-num" id="admin-live-num">‚Äî</div>
                            </div>
                        </div>

                        <div style="display:flex;flex-direction:column;gap:12px;align-items:center;">
                            <!-- Manual Draw -->
                            <button class="draw-btn" id="btn-draw" onclick="manualDraw()">
                                üéØ <span>DRAW</span>
                            </button>
                            <!-- Called count -->
                            <div style="text-align:center;">
                                <div
                                    style="font-size:0.65rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px;">
                                    Called</div>
                                <div style="font-family:'Poppins',sans-serif;font-size:1.1rem;font-weight:700;"
                                    id="called-count">0/90</div>
                            </div>
                        </div>
                    </div>

                    <!-- Speed Slider -->
                    <div class="speed-row">
                        <label>Auto Speed</label>
                        <input type="range" min="3" max="30" value="10" id="speed-slider"
                            oninput="updateSpeed(this.value)">
                        <div class="speed-val" id="speed-display">10s</div>
                    </div>

                    <!-- Number Board -->
                    <div class="section-title" style="margin-top:4px;">üìã Number Board</div>
                    <div class="number-board" id="admin-board"></div>
                </div>

                <!-- Pattern & Prize -->
                <div class="card cyan-top">
                    <div class="section-title">üèÜ Pattern & Prize Pool</div>
                    <button class="g-btn gold">ü•á Edit Winning Patterns</button>
                    <button class="g-btn cyan">üí∞ Configure Prize Pool</button>
                    <button class="g-btn purple">üìé Export Results PDF</button>
                    <div
                        style="margin-top:10px;padding:12px;background:var(--card2);border-radius:10px;border-left:3px solid var(--gold);">
                        <div
                            style="font-size:0.7rem;color:var(--muted);text-transform:uppercase;letter-spacing:2px;margin-bottom:5px;">
                            Active Ruleset</div>
                        <div style="font-weight:800;font-size:0.95rem;">Early 5 ¬∑ Top Row ¬∑ Mid Row ¬∑ Bot Row ¬∑ Full
                            House</div>
                    </div>
                </div>
            </div>

            <!-- ===== PAGE: CLAIMS ===== -->
            <div class="page" id="page-claims">
                <div class="card red-top">
                    <div class="section-title">üîî Pending Claims (7)</div>
                    <div id="claims-list">
                        <!-- Populated by JS -->
                    </div>
                </div>
                <div class="card green-top">
                    <div class="section-title">‚úÖ Approved Today</div>
                    <div style="text-align:center;padding:20px;color:var(--muted);font-size:0.9rem;">Full House ¬∑ Player
                        #ST-4921 ¬∑ ‚Çπ5,000</div>
                </div>
            </div>

            <!-- ===== PAGE: PLAYERS ===== -->
            <div class="page" id="page-players">
                <div class="card purple-top">
                    <div class="section-title">üë• Live Players (1,240)</div>
                    <div style="display:flex;gap:8px;margin-bottom:12px;">
                        <input type="text" placeholder="üîç Search player..."
                            style="flex:1;background:var(--card2);border:1px solid var(--border);border-radius:10px;padding:10px 14px;color:var(--text);outline:none;font-family:'Nunito',sans-serif;font-size:0.85rem;">
                        <button class="g-btn red" style="width:auto;padding:10px 14px;margin:0;">Filter</button>
                    </div>
                    <div id="player-list">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </div>

            <!-- ===== PAGE: REVENUE ===== -->
            <div class="page" id="page-wallet">
                <div class="card gold-top">
                    <div class="section-title">üí∞ Revenue Overview</div>
                    <div class="wallet-row">
                        <div class="wr-label">Today's Revenue</div>
                        <div class="wr-val c-green">‚Çπ24,500</div>
                    </div>
                    <div class="wallet-row">
                        <div class="wr-label">Total Prize Paid</div>
                        <div class="wr-val c-red">‚Çπ18,000</div>
                    </div>
                    <div class="wallet-row">
                        <div class="wr-label">Net Profit</div>
                        <div class="wr-val c-gold">‚Çπ6,500</div>
                    </div>
                    <div class="wallet-row">
                        <div class="wr-label">Agent Commissions</div>
                        <div class="wr-val c-purple">‚Çπ2,200</div>
                    </div>
                </div>
                <div class="card cyan-top">
                    <div class="section-title">üè¶ Withdrawal Requests</div>
                    <button class="g-btn green">‚úÖ Approve All Pending</button>
                    <button class="g-btn red">üì§ Export Transactions</button>
                    <button class="g-btn cyan">üßæ Generate Report</button>
                </div>
                <div class="card purple-top">
                    <div class="section-title">ü§ù Agent Commissions</div>
                    <div class="wallet-row">
                        <div class="wr-label">Agent A ‚Äì Rahul</div>
                        <div class="wr-val c-gold">‚Çπ820</div>
                    </div>
                    <div class="wallet-row">
                        <div class="wr-label">Agent B ‚Äì Priya</div>
                        <div class="wr-val c-gold">‚Çπ650</div>
                    </div>
                    <div class="wallet-row">
                        <div class="wr-label">Agent C ‚Äì Kumar</div>
                        <div class="wr-val c-gold">‚Çπ730</div>
                    </div>
                    <button class="g-btn gold" style="margin-top:8px;">Pay All Commissions</button>
                </div>
            </div>

            <!-- ===== PAGE: SETTINGS ===== -->
            <div class="page" id="page-settings">
                <div class="card purple-top">
                    <div class="section-title">‚öôÔ∏è Game Settings</div>
                    <div class="toggle-row">
                        <div>
                            <div class="toggle-lbl">AI Auto Caller</div>
                            <div class="toggle-sub">Automatically draw numbers</div>
                        </div>
                        <label class="switch"><input type="checkbox" id="ai-toggle"><span class="slider"></span></label>
                    </div>
                    <div class="toggle-row">
                        <div>
                            <div class="toggle-lbl">Anti Cheat Mode</div>
                            <div class="toggle-sub">Server-side claim validation</div>
                        </div>
                        <label class="switch"><input type="checkbox" checked><span class="slider"></span></label>
                    </div>
                    <div class="toggle-row">
                        <div>
                            <div class="toggle-lbl">Allow New Registrations</div>
                            <div class="toggle-sub">Players can join mid-game</div>
                        </div>
                        <label class="switch"><input type="checkbox" checked><span class="slider"></span></label>
                    </div>
                    <div class="toggle-row">
                        <div>
                            <div class="toggle-lbl">Sound Alerts</div>
                            <div class="toggle-sub">Play number call sounds</div>
                        </div>
                        <label class="switch"><input type="checkbox" checked><span class="slider"></span></label>
                    </div>
                    <div class="toggle-row">
                        <div>
                            <div class="toggle-lbl">Maintenance Mode</div>
                            <div class="toggle-sub">Lock game for all players</div>
                        </div>
                        <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                    </div>
                </div>
                <div class="card red-top">
                    <div class="section-title">üõ°Ô∏è Security & Access</div>
                    <button class="g-btn red">üî® Ban Hammer ‚Äì Player Management</button>
                    <button class="g-btn orange"
                        style="--orange:#f97316;border-color:rgba(249,115,22,0.4);color:#f97316;">üö® View Suspicious
                        Activity Log</button>
                    <button class="g-btn ghost">üîë Change Admin Password</button>
                    <button class="g-btn ghost">üìã View Full Audit Trail</button>
                </div>
            </div>

            <!-- Bottom Nav -->
            <nav class="bottom-nav">
                <button class="bnav-item active" onclick="switchTab('game', null, this)">
                    <div class="bi-icon">üéÆ</div>
                    <div class="bi-label">Game</div>
                </button>
                <button class="bnav-item" onclick="switchTab('claims', null, this)">
                    <div class="bi-icon">‚úÖ</div>
                    <div class="bi-label">Claims</div>
                </button>
                <button class="bnav-item" onclick="switchTab('players', null, this)">
                    <div class="bi-icon">üë•</div>
                    <div class="bi-label">Players</div>
                </button>
                <button class="bnav-item" onclick="switchTab('wallet', null, this)">
                    <div class="bi-icon">üí∞</div>
                    <div class="bi-label">Revenue</div>
                </button>
                <button class="bnav-item" onclick="switchTab('settings', null, this)">
                    <div class="bi-icon">‚öôÔ∏è</div>
                    <div class="bi-label">Settings</div>
                </button>
            </nav>
        </div><!-- /view-dash -->
    </div><!-- /app -->

    <script type="module">
        import { db, ref, set, onValue } from '../js/firebase-config.js';
        const ROOM_ID = 'global-room-1';

        // ---- LOGIN ----
        document.getElementById('login-form').addEventListener('submit', e => {
            e.preventDefault();
            if (document.getElementById('admin-id').value && document.getElementById('admin-pass').value) {
                document.getElementById('view-login').classList.add('hidden');
                document.getElementById('view-dash').classList.remove('hidden');
                buildBoard(); populateClaims(); populatePlayers();
            }
        });

        // ---- TABS ----
        window.switchTab = function (tab, tabEl, navEl) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('page-' + tab).classList.add('active');
            if (tabEl) { document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active')); tabEl.classList.add('active'); }
            if (navEl) { document.querySelectorAll('.bnav-item').forEach(b => b.classList.remove('active')); navEl.classList.add('active'); }
        };

        // ---- BOARD ----
        let calledNums = new Set(), latestNum = null, calledCount = 0;
        function buildBoard() {
            const board = document.getElementById('admin-board');
            board.innerHTML = '';
            for (let i = 1; i <= 90; i++) {
                const c = document.createElement('div');
                c.className = 'nb-cell'; c.id = 'anb-' + i; c.textContent = i;
                board.appendChild(c);
            }
        }

        function showNum(num) {
            if (latestNum) {
                const p = document.getElementById('anb-' + latestNum);
                if (p) { p.classList.remove('latest'); p.classList.add('called'); }
            }
            calledNums.add(num); latestNum = num; calledCount++;
            const c = document.getElementById('anb-' + num);
            if (c) c.classList.add('latest');
            document.getElementById('admin-live-num').textContent = num;
            document.getElementById('called-count').textContent = calledCount + '/90';
            const arc = document.getElementById('admin-arc');
            const dash = 276; arc.style.strokeDashoffset = dash - (calledCount / 90) * dash;
        }

        // ---- FIREBASE LISTENER ----
        onValue(ref(db, `rooms/${ROOM_ID}/currentNumber`), snap => {
            const num = snap.val(); if (num) showNum(num);
        });
        onValue(ref(db, `rooms/${ROOM_ID}/state`), snap => {
            if (snap.val() === 'reset') { calledNums.clear(); latestNum = null; calledCount = 0; buildBoard(); document.getElementById('admin-live-num').textContent = '‚Äî'; document.getElementById('called-count').textContent = '0/90'; }
        });

        // ---- MANUAL DRAW ----
        window.manualDraw = function () {
            const available = [];
            for (let i = 1; i <= 90; i++) if (!calledNums.has(i)) available.push(i);
            if (!available.length) { alert('All 90 numbers have been called!'); return; }
            const num = available[Math.floor(Math.random() * available.length)];
            set(ref(db, `rooms/${ROOM_ID}/currentNumber`), num);
        };

        window.initRoom = function () {
            set(ref(db, `rooms/${ROOM_ID}/state`), 'reset');
            set(ref(db, `rooms/${ROOM_ID}/currentNumber`), null);
            set(ref(db, `rooms/${ROOM_ID}/calledNumbers`), []);
            alert('‚úÖ Game Room Initialized & Reset!');
        };

        window.updateSpeed = v => document.getElementById('speed-display').textContent = v + 's';

        let aiInterval = null;
        window.toggleAI = function () {
            const tog = document.getElementById('ai-toggle');
            tog.checked = !tog.checked;
            clearInterval(aiInterval);
            if (tog.checked) {
                const speed = parseInt(document.getElementById('speed-slider').value) * 1000;
                aiInterval = setInterval(() => window.manualDraw(), speed);
                alert('ü§ñ AI Auto-Caller Engaged! Drawing every ' + document.getElementById('speed-slider').value + 's');
            } else { alert('‚õî AI Auto-Caller Stopped.'); }
        };

        // ---- CLAIMS ----
        function populateClaims() {
            const samples = [
                { player: 'Player #ST-4382', pattern: 'Full House', time: '2 min ago' },
                { player: 'Player #ST-1193', pattern: 'Early 5', time: '3 min ago' },
                { player: 'Player #ST-7823', pattern: 'Top Row', time: '5 min ago' },
                { player: 'Player #ST-2201', pattern: 'Bottom Row', time: '7 min ago' },
            ];
            const list = document.getElementById('claims-list');
            samples.forEach(s => {
                list.innerHTML += `<div class="claim-item">
            <div class="ci-info"><div class="ci-player">${s.player}</div><div class="ci-pattern">${s.pattern} ¬∑ ${s.time}</div></div>
            <div class="ci-actions">
                <button class="ci-btn approve" onclick="this.closest('.claim-item').remove()">‚úì Approve</button>
                <button class="ci-btn reject" onclick="this.closest('.claim-item').remove()">‚úó</button>
            </div>
        </div>`;
            });
        }

        // ---- PLAYERS ----
        function populatePlayers() {
            const samples = [
                { name: 'Rahul Sharma', sub: '3 tickets ¬∑ ‚Çπ300', status: 'active' },
                { name: 'Priya Verma', sub: '2 tickets ¬∑ ‚Çπ200', status: 'active' },
                { name: 'Amit Kumar', sub: '5 tickets ¬∑ ‚Çπ500', status: 'active' },
                { name: 'Suspicious_Bot', sub: '12 tickets ¬∑ flagged', status: 'banned' },
                { name: 'Sneha Patel', sub: '1 ticket ¬∑ ‚Çπ100', status: 'active' },
            ];
            const list = document.getElementById('player-list');
            samples.forEach(s => {
                list.innerHTML += `<div class="player-item">
            <div class="pi-info"><div class="pi-name">${s.name}</div><div class="pi-sub">${s.sub}</div></div>
            <span class="pi-badge ${s.status}">${s.status === 'banned' ? 'üö´ Banned' : 'üü¢ Live'}</span>
        </div>`;
            });
        }
    </script>

    <!-- ===== ADMIN PROFILE PANEL ===== -->
    <div class="profile-overlay" id="profile-overlay" onclick="closeProfile(event)">
        <div class="profile-sheet">
            <div class="ps-handle"></div>

            <!-- Photo Upload -->
            <div style="text-align:center;padding:0 20px;">
                <div style="position:relative;width:84px;margin:0 auto 10px;"
                    onclick="document.getElementById('admin-photo-input').click()">
                    <div id="adm-photo-wrap"
                        style="width:84px;height:84px;background:linear-gradient(135deg,var(--a-red),#7c3aed);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:2rem;box-shadow:0 0 25px rgba(255,0,60,0.4);overflow:hidden;cursor:pointer;">
                        <span id="adm-emoji">‚ö°</span>
                        <img id="adm-photo-img" style="display:none;width:100%;height:100%;object-fit:cover;" />
                    </div>
                    <div
                        style="position:absolute;bottom:0;right:0;width:26px;height:26px;background:var(--a-red);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.7rem;border:2px solid var(--bg);">
                        üì∑</div>
                </div>
                <input type="file" id="admin-photo-input" accept="image/*" style="display:none;"
                    onchange="admHandlePhoto(event)">

                <div id="adm-view">
                    <div style="font-size:1.1rem;font-weight:900;" id="adm-display-name">Super Admin</div>
                    <div style="font-size:0.78rem;color:var(--muted);margin:4px 0 12px;">ID: ADMIN-001 ¬∑ God Level
                        Access</div>
                    <button onclick="admEdit(true)"
                        style="padding:7px 22px;background:rgba(255,0,60,0.12);border:1px solid rgba(255,0,60,0.35);border-radius:20px;color:var(--a-red);font-family:'Nunito',sans-serif;font-size:0.82rem;font-weight:700;cursor:pointer;">‚úèÔ∏è
                        Edit Profile</button>
                </div>
                <div id="adm-edit" style="display:none;margin-top:4px;">
                    <input id="adm-ed-name" type="text" value="Super Admin" placeholder="Admin name"
                        style="width:100%;background:rgba(255,255,255,0.07);border:1px solid rgba(255,0,60,0.3);border-radius:10px;padding:10px 13px;color:#fff;font-family:'Nunito',sans-serif;font-size:0.9rem;outline:none;margin-bottom:7px;">
                    <input id="adm-ed-phone" type="tel" placeholder="üì± Phone number"
                        style="width:100%;background:rgba(255,255,255,0.07);border:1px solid rgba(255,0,60,0.3);border-radius:10px;padding:10px 13px;color:#fff;font-family:'Nunito',sans-serif;font-size:0.9rem;outline:none;margin-bottom:7px;">
                    <input id="adm-ed-email" type="email" placeholder="‚úâÔ∏è Email address"
                        style="width:100%;background:rgba(255,255,255,0.07);border:1px solid rgba(255,0,60,0.3);border-radius:10px;padding:10px 13px;color:#fff;font-family:'Nunito',sans-serif;font-size:0.9rem;outline:none;margin-bottom:9px;">
                    <div style="display:flex;gap:8px;">
                        <button onclick="admSave()"
                            style="flex:1;padding:11px;background:linear-gradient(135deg,var(--a-red),#cc0030);border:none;border-radius:10px;color:#fff;font-family:'Nunito',sans-serif;font-weight:800;cursor:pointer;">üíæ
                            Save</button>
                        <button onclick="admEdit(false)"
                            style="padding:11px 16px;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.1);border-radius:10px;color:var(--muted);font-family:'Nunito',sans-serif;font-weight:700;cursor:pointer;">Cancel</button>
                    </div>
                </div>
            </div>

            <div style="height:1px;background:rgba(255,255,255,0.06);margin:14px 0;"></div>

            <div class="ps-rows" style="max-height:160px;overflow-y:auto;">
                <div class="ps-row" onclick="openCreateGame()">
                    <div class="ps-row-icon">üéÆ</div>
                    <div class="ps-row-label" style="color:var(--a-red);font-weight:900;">Create New Game</div>
                    <div class="ps-row-arrow">‚Ä∫</div>
                </div>
                <div class="ps-row">
                    <div class="ps-row-icon">üîë</div>
                    <div class="ps-row-label">Change Password</div>
                    <div class="ps-row-arrow">‚Ä∫</div>
                </div>
                <div class="ps-row">
                    <div class="ps-row-icon">üõ°Ô∏è</div>
                    <div class="ps-row-label">Security Settings</div>
                    <div class="ps-row-arrow">‚Ä∫</div>
                </div>
                <div class="ps-row">
                    <div class="ps-row-icon">üì¢</div>
                    <div class="ps-row-label">Broadcast Announcement</div>
                    <div class="ps-row-arrow">‚Ä∫</div>
                </div>
            </div>
            <button class="ps-logout-btn" onclick="location.reload()">üö™ Logout from God Panel</button>
        </div>
    </div>

    <!-- ===== CREATE GAME MODAL ===== -->
    <div class="profile-overlay" id="game-overlay" onclick="closeCreateGame(event)">
        <div class="profile-sheet" style="border-top-color:rgba(245,158,11,0.5);">
            <div class="ps-handle"></div>
            <div style="padding:0 20px 4px;text-align:center;">
                <div style="font-size:1.5rem;margin-bottom:4px;">üéÆ</div>
                <div style="font-family:'Poppins',sans-serif;font-size:1.1rem;font-weight:700;margin-bottom:4px;">Create
                    New Game</div>
                <div style="font-size:0.8rem;color:var(--muted);margin-bottom:18px;">Configure and launch a new Tambola
                    session</div>
            </div>
            <div style="padding:0 20px;">
                <label
                    style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.5px;color:var(--muted);display:block;margin-bottom:6px;">Game
                    Room Name</label>
                <input id="cg-name" type="text" placeholder="e.g. Evening Tambola #1"
                    style="width:100%;background:rgba(255,255,255,0.07);border:1px solid rgba(245,158,11,0.3);border-radius:10px;padding:11px 14px;color:#fff;font-family:'Nunito',sans-serif;font-size:0.9rem;outline:none;margin-bottom:12px;">

                <label
                    style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.5px;color:var(--muted);display:block;margin-bottom:6px;">Ticket
                    Price (‚Çπ)</label>
                <input id="cg-price" type="number" placeholder="100" value="100"
                    style="width:100%;background:rgba(255,255,255,0.07);border:1px solid rgba(245,158,11,0.3);border-radius:10px;padding:11px 14px;color:#fff;font-family:'Nunito',sans-serif;font-size:0.9rem;outline:none;margin-bottom:12px;">

                <label
                    style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.5px;color:var(--muted);display:block;margin-bottom:6px;">Draw
                    Speed (seconds)</label>
                <input id="cg-speed" type="number" placeholder="10" value="10" min="3" max="60"
                    style="width:100%;background:rgba(255,255,255,0.07);border:1px solid rgba(245,158,11,0.3);border-radius:10px;padding:11px 14px;color:#fff;font-family:'Nunito',sans-serif;font-size:0.9rem;outline:none;margin-bottom:12px;">

                <label
                    style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.5px;color:var(--muted);display:block;margin-bottom:8px;">Winning
                    Patterns</label>
                <div style="display:flex;flex-wrap:wrap;gap:8px;margin-bottom:16px;">
                    <label
                        style="display:flex;align-items:center;gap:6px;background:rgba(255,255,255,0.05);padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);cursor:pointer;font-size:0.85rem;font-weight:600;"><input
                            type="checkbox" checked style="accent-color:var(--a-red);"> Early 5</label>
                    <label
                        style="display:flex;align-items:center;gap:6px;background:rgba(255,255,255,0.05);padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);cursor:pointer;font-size:0.85rem;font-weight:600;"><input
                            type="checkbox" checked style="accent-color:var(--a-red);"> Top Row</label>
                    <label
                        style="display:flex;align-items:center;gap:6px;background:rgba(255,255,255,0.05);padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);cursor:pointer;font-size:0.85rem;font-weight:600;"><input
                            type="checkbox" checked style="accent-color:var(--a-red);"> Mid Row</label>
                    <label
                        style="display:flex;align-items:center;gap:6px;background:rgba(255,255,255,0.05);padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);cursor:pointer;font-size:0.85rem;font-weight:600;"><input
                            type="checkbox" checked style="accent-color:var(--a-red);"> Bot Row</label>
                    <label
                        style="display:flex;align-items:center;gap:6px;background:rgba(255,255,255,0.05);padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);cursor:pointer;font-size:0.85rem;font-weight:600;"><input
                            type="checkbox" checked style="accent-color:var(--a-red);"> Full House</label>
                </div>

                <button onclick="launchGame()"
                    style="width:100%;padding:14px;background:linear-gradient(135deg,var(--a-red),#cc0030);border:none;border-radius:12px;color:#fff;font-family:'Nunito',sans-serif;font-size:1rem;font-weight:900;cursor:pointer;box-shadow:0 4px 25px rgba(255,0,60,0.4);letter-spacing:1px;margin-bottom:10px;">üöÄ
                    Launch Game Room</button>
                <button onclick="closeCreateGame(null)"
                    style="width:100%;padding:12px;background:transparent;border:1px solid rgba(255,255,255,0.1);border-radius:12px;color:var(--muted);font-family:'Nunito',sans-serif;font-size:0.9rem;font-weight:700;cursor:pointer;margin-bottom:20px;">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        window.openProfile = function () { document.getElementById('profile-overlay').classList.add('open'); };
        window.closeProfile = function (e) { if (!e || e.target === document.getElementById('profile-overlay')) { document.getElementById('profile-overlay').classList.remove('open'); admEdit(false); } };
        window.admEdit = function (on) { document.getElementById('adm-view').style.display = on ? 'none' : 'block'; document.getElementById('adm-edit').style.display = on ? 'block' : 'none'; };
        window.admSave = function () { const n = document.getElementById('adm-ed-name').value.trim() || 'Super Admin'; document.getElementById('adm-display-name').textContent = n; admEdit(false); alert('‚úÖ Admin profile updated!'); };
        window.admHandlePhoto = function (e) { const f = e.target.files[0]; if (!f) return; const r = new FileReader(); r.onload = ev => { document.getElementById('adm-emoji').style.display = 'none'; const i = document.getElementById('adm-photo-img'); i.src = ev.target.result; i.style.display = 'block'; }; r.readAsDataURL(f); };
        window.openCreateGame = function () { document.getElementById('profile-overlay').classList.remove('open'); setTimeout(() => document.getElementById('game-overlay').classList.add('open'), 100); };
        window.closeCreateGame = function (e) { if (!e || e.target === document.getElementById('game-overlay')) document.getElementById('game-overlay').classList.remove('open'); };
    </script>

    <!-- ===== PHASE 3: ADMIN FIREBASE INTEGRATION ===== -->
    <script type="module">
        import { TambolaBoard } from '../../js/tambola-engine.js';
        import { createGame, adminDrawNumber, adminResetGame, adminResolveClaim, listenToClaims } from '../../js/multiplayer.js';
        import { announceNumber, SFX } from '../../js/sounds.js';

        const board = new TambolaBoard();
        board.initUI('number-board');

        let autoDrawInterval = null;
        let currentGameId = 'game_' + Date.now();
        let gameActive = false;

        // ‚îÄ‚îÄ Create Game (wires the modal Launch button) ‚îÄ‚îÄ
        window.launchGame = async function () {
            const name = document.getElementById('cg-name').value.trim() || 'Tambola Room 1';
            const price = parseInt(document.getElementById('cg-price').value) || 100;
            const speed = parseInt(document.getElementById('cg-speed').value) || 10;
            const patterns = [];
            document.querySelectorAll('#game-overlay input[type=checkbox]:checked').forEach((cb, i) => {
                const p = ['early5', 'topRow', 'midRow', 'botRow', 'fullHouse'][i];
                if (p) patterns.push(p);
            });

            currentGameId = 'game_' + Date.now();
            await createGame(currentGameId, { name, ticketPrice: price, drawSpeed: speed, patterns });
            window.closeCreateGame(null);
            gameActive = true;
            SFX.gameStart();
            // Update speed slider if present
            const slider = document.getElementById('speed-slider');
            if (slider) slider.value = speed;
            alert(`üéÆ Game "${name}" is LIVE!\nRoom ID: ${currentGameId}\nPlayers can now join!`);
        };

        // ‚îÄ‚îÄ Manual Draw ‚îÄ‚îÄ
        window.p3DrawNumber = async function () {
            if (!gameActive) { alert('Create a game first using the profile icon ‚Üí Create New Game'); return; }
            const num = board.drawNumber(false); // don't use local announce ‚Äî we'll push to Firebase
            if (!num) { alert('All 90 numbers have been drawn! Game over.'); return; }
            await adminDrawNumber(num);
            announceNumber(num);
            // Update current number display
            const disp = document.getElementById('current-number-display');
            if (disp) disp.textContent = num;
            const lastEl = document.getElementById('last-called-num');
            if (lastEl) lastEl.textContent = num;
        };

        // Hook existing draw button
        const drawBtn = document.getElementById('draw-btn') || document.querySelector('[onclick*="draw"]');
        if (drawBtn) {
            drawBtn.removeAttribute('onclick');
            drawBtn.addEventListener('click', () => window.p3DrawNumber());
        }

        // ‚îÄ‚îÄ Auto Draw Toggle ‚îÄ‚îÄ
        window.p3ToggleAutoDraw = function (enabled, speedSeconds) {
            if (autoDrawInterval) { clearInterval(autoDrawInterval); autoDrawInterval = null; }
            if (enabled) {
                autoDrawInterval = setInterval(() => window.p3DrawNumber(), (speedSeconds || 10) * 1000);
            }
        };

        // Hook speed slider
        const slider = document.getElementById('speed-slider');
        if (slider) slider.addEventListener('input', () => {
            if (autoDrawInterval) window.p3ToggleAutoDraw(true, parseInt(slider.value));
        });

        // Hook AI auto toggle
        const autoToggle = document.getElementById('toggle-ai-caller');
        if (autoToggle) autoToggle.addEventListener('change', () => {
            const speed = slider ? parseInt(slider.value) : 10;
            window.p3ToggleAutoDraw(autoToggle.checked, speed);
        });

        // ‚îÄ‚îÄ Game Reset ‚îÄ‚îÄ
        window.p3ResetGame = async function () {
            if (!confirm('Reset game? This will clear all called numbers and claims.')) return;
            board.reset();
            await adminResetGame();
            if (autoDrawInterval) { clearInterval(autoDrawInterval); autoDrawInterval = null; }
            const disp = document.getElementById('current-number-display');
            if (disp) disp.textContent = '?';
            SFX.error();
        };
        const resetBtn = document.getElementById('reset-btn') || document.querySelector('[onclick*="reset"]');
        if (resetBtn) { resetBtn.removeAttribute('onclick'); resetBtn.addEventListener('click', window.p3ResetGame); }

        // ‚îÄ‚îÄ Live Claims Listener ‚îÄ‚îÄ
        listenToClaims((claims) => {
            const container = document.getElementById('claims-container');
            if (!container) return;
            if (claims.length === 0) {
                container.innerHTML = '<div style="text-align:center;color:var(--muted);padding:30px;font-size:0.9rem;">No claims yet</div>';
                return;
            }
            container.innerHTML = claims.filter(c => c.status === 'pending').map(claim => `
                <div class="claim-item" id="claim-${claim.id}">
                    <div class="ci-info">
                        <div class="ci-name">${claim.playerName || 'Player'}</div>
                        <div class="ci-type">${claim.pattern?.toUpperCase() || 'CLAIM'} ¬∑ ${(claim.matchedNumbers || []).join(', ')}</div>
                    </div>
                    <div style="display:flex;gap:6px;">
                        <button class="ci-btn approve" onclick="p3ApproveClaim('${claim.id}', 500)">‚úì Approve</button>
                        <button class="ci-btn reject" onclick="p3RejectClaim('${claim.id}')">‚úó Reject</button>
                    </div>
                </div>
            `).join('');
        });

        window.p3ApproveClaim = async function (claimId, prize) {
            await adminResolveClaim(claimId, 'approved', prize);
            SFX.claimApproved();
            const el = document.getElementById(`claim-${claimId}`);
            if (el) { el.style.background = 'rgba(16,185,129,0.15)'; el.style.border = '1px solid var(--green)'; }
        };
        window.p3RejectClaim = async function (claimId) {
            await adminResolveClaim(claimId, 'rejected', 0);
            SFX.claimRejected();
            const el = document.getElementById(`claim-${claimId}`);
            if (el) { el.style.opacity = '0.4'; }
        };

        // Expose for inline onclick
        window.p3 = { board, gameActive: () => gameActive };
    </script>

    <!-- ===== PHASE 4: ADMIN ANALYTICS + BROADCAST + BOOKING ===== -->
    <script type="module">
        import { getAdminStats, listenToLiveStats, renderBarChart } from '../../js/analytics.js';
        import { sendBroadcast, showToast, BROADCAST_TEMPLATES } from '../../js/broadcast.js';
        import { listenToSeats, initGameSeats } from '../../js/booking.js';

        // ‚îÄ‚îÄ Analytics Tab Renderer ‚îÄ‚îÄ
        async function renderAnalytics() {
            const container = document.getElementById('analytics-container');
            if (!container) return;
            container.innerHTML = '<div style="text-align:center;padding:30px;color:var(--muted);">‚è≥ Loading stats...</div>';

            const stats = await getAdminStats();

            container.innerHTML = `
                <!-- Stat Cards -->
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px;">
                    <div style="background:var(--card);border-radius:14px;padding:16px;border:1px solid var(--border);text-align:center;">
                        <div style="font-size:1.8rem;font-weight:900;color:var(--neon);">${stats.totalGames}</div>
                        <div style="font-size:0.72rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px;">Total Games</div>
                    </div>
                    <div style="background:var(--card);border-radius:14px;padding:16px;border:1px solid var(--border);text-align:center;">
                        <div style="font-size:1.8rem;font-weight:900;color:var(--green);">‚Çπ${(stats.totalRevenue || 0).toLocaleString()}</div>
                        <div style="font-size:0.72rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px;">Revenue</div>
                    </div>
                    <div style="background:var(--card);border-radius:14px;padding:16px;border:1px solid var(--border);text-align:center;">
                        <div style="font-size:1.8rem;font-weight:900;color:var(--a-red);">‚Çπ${(stats.totalPrizes || 0).toLocaleString()}</div>
                        <div style="font-size:0.72rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px;">Prizes Paid</div>
                    </div>
                    <div style="background:var(--card);border-radius:14px;padding:16px;border:1px solid var(--border);text-align:center;">
                        <div style="font-size:1.8rem;font-weight:900;color:var(--gold);">${stats.totalPlayers}</div>
                        <div style="font-size:0.72rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px;">Players</div>
                    </div>
                </div>

                <!-- Revenue Chart -->
                <div style="background:var(--card);border-radius:14px;padding:16px;margin-bottom:12px;border:1px solid var(--border);">
                    <div style="font-weight:800;font-size:0.85rem;margin-bottom:12px;">üìà Revenue by Day</div>
                    <div id="revenue-chart"></div>
                </div>

                <!-- Top Agents -->
                ${stats.agentStats.length ? `
                <div style="background:var(--card);border-radius:14px;padding:16px;margin-bottom:12px;border:1px solid var(--border);">
                    <div style="font-weight:800;font-size:0.85rem;margin-bottom:12px;">üèÖ Top Agents</div>
                    ${stats.agentStats.map((a, i) => `
                        <div style="display:flex;align-items:center;gap:10px;padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.04);">
                            <div style="width:24px;text-align:center;font-weight:900;color:var(--gold);">#${i + 1}</div>
                            <div style="flex:1;font-weight:700;">${a.name}</div>
                            <div style="font-size:0.8rem;color:var(--muted);">${a.referred} players</div>
                        </div>`).join('')}
                </div>` : ''}

                <!-- Recent Games -->
                <div style="background:var(--card);border-radius:14px;padding:16px;border:1px solid var(--border);">
                    <div style="font-weight:800;font-size:0.85rem;margin-bottom:12px;">üéÆ Recent Games</div>
                    <div style="overflow-x:auto;">
                        <table style="width:100%;border-collapse:collapse;font-size:0.78rem;">
                            <tr style="color:var(--muted);text-align:left;border-bottom:1px solid rgba(255,255,255,0.06);">
                                <th style="padding:6px 4px;">Name</th>
                                <th style="padding:6px 4px;">Players</th>
                                <th style="padding:6px 4px;">Revenue</th>
                                <th style="padding:6px 4px;">Date</th>
                            </tr>
                            ${(stats.recentGames || []).map(g => `
                            <tr style="border-bottom:1px solid rgba(255,255,255,0.04);">
                                <td style="padding:8px 4px;font-weight:700;">${g.name}</td>
                                <td style="padding:8px 4px;">${g.players}</td>
                                <td style="padding:8px 4px;color:var(--green);">‚Çπ${g.revenue}</td>
                                <td style="padding:8px 4px;color:var(--muted);">${g.date}</td>
                            </tr>`).join('') || '<tr><td colspan="4" style="text-align:center;padding:20px;color:var(--muted);">No games yet</td></tr>'}
                        </table>
                    </div>
                </div>`;

            // Render revenue chart
            renderBarChart(document.getElementById('revenue-chart'), stats.byDay, 'var(--a-red)');
        }

        // Trigger analytics load when analytics tab is clicked
        document.querySelectorAll('[data-tab]').forEach(btn => {
            btn.addEventListener('click', () => {
                if (btn.dataset.tab === 'analytics') renderAnalytics();
            });
        });
        // Also expose for manual trigger
        window.p4LoadAnalytics = renderAnalytics;

        // ‚îÄ‚îÄ Broadcast Panel ‚îÄ‚îÄ
        const broadcastContainer = document.getElementById('broadcast-container');
        if (broadcastContainer) {
            broadcastContainer.innerHTML = `
                <div style="margin-bottom:12px;">
                    <textarea id="broadcast-msg" placeholder="Type your announcement..." rows="3" style="width:100%;background:rgba(255,255,255,0.06);border:1px solid rgba(255,0,60,0.25);border-radius:10px;padding:12px;color:#fff;font-family:'Nunito',sans-serif;font-size:0.9rem;resize:none;outline:none;"></textarea>
                </div>
                <div style="display:flex;flex-wrap:wrap;gap:6px;margin-bottom:12px;">
                    ${BROADCAST_TEMPLATES.map((t, i) => `<button onclick="p4SendTemplate(${i})" style="padding:8px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:rgba(255,255,255,0.7);font-family:'Nunito',sans-serif;font-size:0.78rem;font-weight:700;cursor:pointer;">${t.label}</button>`).join('')}
                </div>
                <button onclick="p4Send()" style="width:100%;padding:13px;background:linear-gradient(135deg,var(--a-red),#cc0030);border:none;border-radius:10px;color:#fff;font-family:'Nunito',sans-serif;font-size:0.95rem;font-weight:900;cursor:pointer;">üì¢ Send to All Players</button>
            `;
        }

        window.p4Send = async function () {
            const msg = document.getElementById('broadcast-msg')?.value?.trim();
            if (!msg) { showToast('Enter a message first', 'warning'); return; }
            await sendBroadcast(msg, 'info', 'Admin');
            showToast('üì¢ Broadcast sent!', 'game', 3000);
            const el = document.getElementById('broadcast-msg');
            if (el) el.value = '';
        };

        window.p4SendTemplate = async function (idx) {
            const t = BROADCAST_TEMPLATES[idx];
            if (!t) return;
            await sendBroadcast(t.message, t.type, 'Admin');
            showToast(`üì¢ "${t.label}" sent!`, 'game', 3000);
        };

        // ‚îÄ‚îÄ Live Seat Overview ‚îÄ‚îÄ
        const seatOverview = document.getElementById('seat-overview');
        if (seatOverview) {
            listenToSeats(window.currentGameId || 'game_default', (seats) => {
                const total = Object.keys(seats).length;
                const sold = Object.values(seats).filter(s => s.status === 'sold').length;
                const avail = total - sold;
                seatOverview.innerHTML = `
                    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:12px;">
                        <div style="background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:10px;padding:12px;text-align:center;">
                            <div style="font-size:1.4rem;font-weight:900;color:var(--green);">${avail}</div>
                            <div style="font-size:0.65rem;color:var(--muted);">Available</div>
                        </div>
                        <div style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.3);border-radius:10px;padding:12px;text-align:center;">
                            <div style="font-size:1.4rem;font-weight:900;color:var(--neon);">${sold}</div>
                            <div style="font-size:0.65rem;color:var(--muted);">Sold</div>
                        </div>
                        <div style="background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:10px;padding:12px;text-align:center;">
                            <div style="font-size:1.4rem;font-weight:900;">${total}</div>
                            <div style="font-size:0.65rem;color:var(--muted);">Total</div>
                        </div>
                    </div>
                    <div style="background:rgba(16,185,129,0.08);border-radius:8px;height:8px;overflow:hidden;">
                        <div style="width:${total > 0 ? Math.round((sold / total) * 100) : 0}%;height:100%;background:linear-gradient(90deg,var(--green),var(--cyan));transition:width 0.5s;"></div>
                    </div>
                    <div style="font-size:0.72rem;color:var(--muted);text-align:center;margin-top:6px;">${total > 0 ? Math.round((sold / total) * 100) : 0}% sold</div>`;
            });
        }
    </script>

    <!-- ===== PHASE 5: ADMIN LEADERBOARD + CHAT + PRIZEPOOL + LOBBY ===== -->
    <script type="module">
        import { getAllTimeLeaderboard, renderLeaderboard } from '../../js/leaderboard.js';
        import { mountChat, sendMessage } from '../../js/chat.js';
        import { listenToPrizePool, renderPrizePool, getPatternPrize, savePrizeConfig } from '../../js/prizepool.js';
        import { listenToLobby, renderLobby, endRoom } from '../../js/lobby.js';

        // -- Admin Leaderboard --
        const lbContainer = document.getElementById('admin-leaderboard-container');
        if (lbContainer) {
            getAllTimeLeaderboard().then(data => renderLeaderboard(lbContainer, data));
        }

        // -- Admin Chat --
        const chatContainer = document.getElementById('admin-chat-container');
        if (chatContainer) {
            mountChat(chatContainer, window.currentGameId || 'game_default', { uid: 'admin', name: 'Admin', role: 'admin' });
        }

        // -- Live Prize Pool for current game --
        const ppContainer = document.getElementById('admin-prize-pool-container');
        if (ppContainer) {
            listenToPrizePool(window.currentGameId || 'game_default', (data) => {
                renderPrizePool(ppContainer, data);
            });
        }

        // -- Wire prize config save --
        window.p5SavePrizeConfig = async function () {
            const poolPct = parseInt(document.getElementById('prize-pool-pct')?.value) || 80;
            await savePrizeConfig(window.currentGameId || 'game_default', poolPct);
            window.showToast?.('Prize config saved!', 'game');
        };

        // -- Auto-fill prize on claim approval --
        const origApprove = window.p3ApproveClaim;
        window.p3ApproveClaim = async function (claimId, defaultPrize) {
            const gameId = window.currentGameId || 'game_default';
            const claimEl = document.getElementById(`claim-${claimId}`);
            const pattern = claimEl?.querySelector('.ci-type')?.textContent?.split(' ')[0]?.toLowerCase() || 'fullHouse';
            const autoPrize = await getPatternPrize(gameId, pattern) || defaultPrize;
            if (origApprove) await origApprove(claimId, autoPrize);
        };

        // -- Room Lobby (Admin view: all rooms, end button) --
        const lobbyContainer = document.getElementById('admin-lobby-container');
        if (lobbyContainer) {
            listenToLobby((rooms) => {
                renderLobby(lobbyContainer, rooms, null, true);
            }, true);
        }
    </script>
</body>

</html>